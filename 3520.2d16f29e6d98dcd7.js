"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3520],{3520:(k,h,i)=>{i.r(h),i.d(h,{ChatPageModule:()=>w});var g=i(6814),l=i(6223),r=i(1929),d=i(638),p=i(5861),u=i(5887),C=i(553),t=i(9212),M=i(6658);function v(n,o){1&n&&(t.TgZ(0,"div",17),t._UZ(1,"ion-skeleton-text",18),t.qZA()),2&n&&(t.xp6(1),t.Q6J("animated",!0))}const x=()=>[1,2,3,4,5,6,7,8,9];function P(n,o){1&n&&(t.TgZ(0,"div",15),t.YNc(1,v,2,1,"div",16),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,x)))}function O(n,o){if(1&n&&(t.TgZ(0,"div",19)(1,"div"),t._uU(2),t.qZA(),t.TgZ(3,"div",20),t._uU(4),t.ALo(5,"date"),t.qZA()()),2&n){const s=o.$implicit,e=t.oxw();t.ekj("received",s.sender===e.idReceptor)("sent",s.sender===e.userInfo),t.xp6(2),t.Oqu(s.text),t.xp6(2),t.Oqu(t.xi3(5,6,s.timestamp,"short"))}}const f=C.N.url,_=[{path:":idReceptor/:userInfo",component:(()=>{var n;class o{constructor(e,a){this.route=e,this.chatService=a,this.messageList=[],this.socket=(0,u.io)(`${f}`)}ngOnInit(){var e=this;return(0,p.Z)(function*(){e.idReceptor=e.route.snapshot.paramMap.get("idReceptor"),e.userInfo=e.route.snapshot.paramMap.get("userInfo"),e.socket=(0,u.io)(f),e.socket.emit("connected",e.userInfo),e.socket.on("connect",()=>{console.log(e.socket.connected),console.log(e.socket.id)}),e.socket.on("newMessage",function(){var a=(0,p.Z)(function*(c){yield e.loadMessage()});return function(c){return a.apply(this,arguments)}}()),yield e.loadMessage()})()}loadMessage(){var e=this;return(0,p.Z)(function*(){const a=yield e.chatService.loadConversation(e.idReceptor,e.userInfo);e.messageList=a.messages;var c=document.getElementById("messageContainer");c&&(c.scrollTop=c.scrollHeight),e.scroll()})()}sendMessage(){this.socket.emit("hello","world"),this.chatService.sendMessage(this.userInfo,this.idReceptor,this.newMessage),this.messageList.push({id:"",sender:this.userInfo,text:this.newMessage}),this.newMessage="",this.scroll()}scroll(){setTimeout(()=>{var e=document.getElementById("messageContainer");e&&(e.scrollTop=e.scrollHeight)},0)}}return(n=o).\u0275fac=function(e){return new(e||n)(t.Y36(d.gz),t.Y36(M.a))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-chat"]],decls:34,vars:5,consts:[[3,"translucent"],["slot","start"],["slot","start","defaultHref","main/tabs/tab2","text","Atras","color","primary"],[3,"fullscreen"],[1,"conversation"],["id","messageContainer",1,"conversation-container"],["class","cargando",4,"ngIf"],["class","message sent",3,"received","sent",4,"ngFor","ngForOf"],[1,"conversation-compose"],["name","input","placeholder","Type a message","autocomplete","off","autofocus","",1,"input-msg",3,"ngModel","ngModelChange","keyup"],[1,"send",3,"click"],[1,"circle"],["version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","width","535.5px","height","535.5px","viewBox","0 0 535.5 535.5",0,"xml","space","preserve",2,"enable-background","new 0 0 535.5 535.5"],["id","send"],["points","0,497.25 535.5,267.75 0,38.25 0,216.75 382.5,267.75 0,318.75 \t\t"],[1,"cargando"],["class","item-cargando",4,"ngFor","ngForOf"],[1,"item-cargando"],[2,"height","3rem","border-radius","1rem",3,"animated"],[1,"message","sent"],[1,"timestamp"]],template:function(e,a){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"Chat"),t.qZA()()(),t.TgZ(6,"ion-content",3)(7,"div",4)(8,"div",5),t.YNc(9,P,2,2,"div",6)(10,O,6,9,"div",7),t.qZA()(),t.TgZ(11,"div",8)(12,"input",9),t.NdJ("ngModelChange",function(m){return a.newMessage=m})("keyup",function(m){return 13==m.keyCode&&a.sendMessage()}),t.qZA(),t.TgZ(13,"button",10),t.NdJ("click",function(){return a.sendMessage()}),t.TgZ(14,"div",11),t.O4$(),t.TgZ(15,"svg",12)(16,"g")(17,"g",13),t._UZ(18,"polygon",14),t.qZA()(),t._UZ(19,"g")(20,"g")(21,"g")(22,"g")(23,"g")(24,"g")(25,"g")(26,"g")(27,"g")(28,"g")(29,"g")(30,"g")(31,"g")(32,"g")(33,"g"),t.qZA()()()()()),2&e&&(t.Q6J("translucent",!0),t.xp6(6),t.Q6J("fullscreen",!0),t.xp6(3),t.Q6J("ngIf",!a.messageList.length),t.xp6(1),t.Q6J("ngForOf",a.messageList),t.xp6(2),t.Q6J("ngModel",a.newMessage))},dependencies:[g.sg,g.O5,l.Fj,l.JJ,l.On,r.Sm,r.W2,r.Gu,r.CK,r.wd,r.sr,r.oU,g.uU],styles:['.mensaje-receptor[_ngcontent-%COMP%]{text-align:left}.mensaje-propio[_ngcontent-%COMP%]{text-align:right}.conversation[_ngcontent-%COMP%]{height:89%;position:relative;z-index:0}.conversation[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{-webkit-transition:all .5s;transition:all .5s;width:5px;height:1px;z-index:10}.conversation[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.conversation[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#b3ada7}.conversation[_ngcontent-%COMP%]   .conversation-container[_ngcontent-%COMP%]{height:97%;box-shadow:inset 0 10px 10px -10px #000;overflow-x:hidden;padding:0 16px;margin-bottom:5px}.conversation[_ngcontent-%COMP%]   .conversation-container[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}.message[_ngcontent-%COMP%]{color:#000;clear:both;line-height:18px;font-size:15px;padding:8px;position:relative;margin:8px 0;max-width:85%;word-wrap:break-word;z-index:-1}.metadata[_ngcontent-%COMP%]{display:inline-block;float:right;padding:0 0 0 7px;bottom:-4px}.metadata[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{color:#00000073;font-size:11px;display:inline-block}.metadata[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;position:relative;top:4px;height:16px;width:16px}.metadata[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;transition:.5s ease-in-out}.metadata[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:first-child{-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:perspective(800px) rotateY(180deg)}.metadata[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:last-child{-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:perspective(800px) rotateY(0)}.metadata[_ngcontent-%COMP%]   .tick-animation[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:first-child{transform:perspective(800px) rotateY(0)}.metadata[_ngcontent-%COMP%]   .tick-animation[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:last-child{transform:perspective(800px) rotateY(-179.9deg)}.message[_ngcontent-%COMP%]:first-child{margin:16px 0 8px}.message.received[_ngcontent-%COMP%]{background:#eaeaea;border-radius:0 9px 9px;float:left}.message.received[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]{padding:0 0 0 16px}.message.received[_ngcontent-%COMP%]:after{border-width:0px 10px 10px 0;border-color:transparent #fff transparent transparent;top:0;left:-10px}.message.sent[_ngcontent-%COMP%]{background:var(--ion-color-primary);border-radius:9px 0 9px 9px;float:right;color:#fff}.conversation-compose[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-end;overflow:hidden;height:50px;width:100%;z-index:2;box-shadow:#403c433d 0 2px 8px;width:98%;margin:auto;border-radius:24px}.conversation-compose[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .conversation-compose[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#fff;height:100%}.conversation-compose[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:1rem}.conversation-compose[_ngcontent-%COMP%]   .emoji[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:white;border-radius:5px 0 0 5px;flex:0 0 auto;margin-left:8px;width:48px}.conversation-compose[_ngcontent-%COMP%]   .input-msg[_ngcontent-%COMP%]{border:0;flex:1 1 auto;font-size:16px;margin:0;outline:none;min-width:50px;color:#000}.conversation-compose[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]{flex:0 0 auto;border-radius:0 0 5px;text-align:center;position:relative;width:48px}.conversation-compose[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]:after{border-width:0px 0 10px 10px;border-color:transparent transparent transparent #fff;border-style:solid;position:absolute;width:0;height:0;content:"";top:0;right:-10px}.conversation-compose[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{display:block;color:#7d8488;font-size:24px;transform:translate(-50%,-50%);position:relative;top:50%;left:50%}.conversation-compose[_ngcontent-%COMP%]   .send[_ngcontent-%COMP%]{background:transparent;flex:0 0 auto;padding:0;position:relative}.conversation-compose[_ngcontent-%COMP%]   .send[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{color:#fff;position:relative;width:48px;height:50px;display:flex;align-items:center;justify-content:center}.conversation-compose[_ngcontent-%COMP%]   .send[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1.5rem;fill:var(--ion-color-primary)}.cargando[_ngcontent-%COMP%]{position:absolute;width:95%;bottom:0}.item-cargando[_ngcontent-%COMP%]{margin:1rem}.message[_ngcontent-%COMP%]{margin-bottom:.5rem}.timestamp[_ngcontent-%COMP%]{font-size:.75rem;color:gray;text-align:right}']}),o})()}];let b=(()=>{var n;class o{}return(n=o).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.Bz.forChild(_),d.Bz]}),o})(),w=(()=>{var n;class o{}return(n=o).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,l.u5,r.Pc,b]}),o})()}}]);